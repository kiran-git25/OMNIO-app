import{C as n}from"./utils-DrYALbGr.js";class i{static generateRoomKey(){const r=new Uint8Array(32);return window.crypto.getRandomValues(r),Array.from(r).map(t=>t.toString(16).padStart(2,"0")).join("")}static encrypt(r,t){if(!r||!t)return null;try{return n.AES.encrypt(r,t).toString()}catch(e){return console.error("Encryption error:",e),null}}static decrypt(r,t){if(!r||!t)return null;try{return n.AES.decrypt(r,t).toString(n.enc.Utf8)}catch(e){return console.error("Decryption error:",e),null}}static encryptFileData(r,t){if(!r||!t)return r;try{const e={...r};return r.name&&(e.encryptedName=this.encrypt(r.name,t)),r.description&&(e.encryptedDescription=this.encrypt(r.description,t)),e.isEncrypted=!0,e.encryptionVersion=1,e}catch(e){return console.error("File encryption error:",e),r}}static decryptFileData(r,t){if(!r||!r.isEncrypted||!t)return r;try{const e={...r};return r.encryptedName&&(e.name=this.decrypt(r.encryptedName,t)),r.encryptedDescription&&(e.description=this.decrypt(r.encryptedDescription,t)),e.isDecrypted=!0,e}catch(e){return console.error("File decryption error:",e),r}}static encryptFileContent(r,t){if(!r||!t)return null;try{const e=n.lib.WordArray.create(r);return n.AES.encrypt(e,t).toString()}catch(e){return console.error("File content encryption error:",e),null}}}class a{constructor(r){this.namespace=r,this.storage=window.localStorage,this.memoryCache={}}get(r){if(this.memoryCache[r]!==void 0)return this.memoryCache[r];const t=`${this.namespace}:${r}`,e=this.storage.getItem(t);if(!e)return null;try{const o=JSON.parse(e);return this.memoryCache[r]=o,o}catch(o){return console.error(`Error retrieving ${r} from secure storage:`,o),null}}set(r,t){this.memoryCache[r]=t;const e=`${this.namespace}:${r}`;try{const o=JSON.stringify(t);this.storage.setItem(e,o)}catch(o){console.error(`Error storing ${r} in secure storage:`,o)}}remove(r){delete this.memoryCache[r];const t=`${this.namespace}:${r}`;this.storage.removeItem(t)}clear(){this.memoryCache={},Object.keys(this.storage).forEach(r=>{r.startsWith(`${this.namespace}:`)&&this.storage.removeItem(r)})}}export{i as E,a as S};
